---
title: RVCExIITB CTF
time: 2024-06-25 12:00:00
categories: [CTF, WriteUps]
tags: [CTF, WriteUps]
image: /assets/posts/RVCECTF/p1.png
---

Commencing our first CTF Write-Up. We’re excited to share the write-ups from the recent RVCExIITB CTF event at R. V. College of Engineering. We post the solves of whatever we managed to do within the time-frame of the CTF. Hope to post the ones we didn't manage to solve as well. Best Ways To Learn. Without further ado, let’s dive right in!



```
Authors: AbuCTF, Rohmat
```

## Forensics

Starting off with Forensics cause it’s everyone’s favorite haha. More like it’s the easiest.

<img src="/assets/posts/RVCECTF/sweat.gif" alt="sweat" width="70%"/>

### **Operation Woofenstein**

Description: Your beloved canine companion Agent Snuggles, has gone missing! You need to find him. Here’s a picture of him. Remember snuggles is the key, even when you may not be able to see him.

Given: `snuggles.jpg`

Author: Ananya Bhat

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics$ file snuggles.jpg
snuggles.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, Exif Standard: [TIFF image data, big-endian, direntries=5, xresolution=74, yresolution=82, resolutionunit=1], baseline, precision 8, 6260x4170, components 3
```

After trying out other standard stuff like `strings`, `binwalk` and so on. `steghide`revealed a zip file underneath.

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics$ steghide extract -sf snuggles.jpg
Enter passphrase:
wrote extracted data to "snuggle.zip".
```

unzipping it, we get

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics$ unzip snuggle.zip
Archive:  snuggle.zip
   creating: snuggles/
   creating: snuggles/notsnuggles/
   creating: snuggles/aerosol/
   creating: snuggles/snuggles/
   creating: snuggles/snuggles/snuggless/
  inflating: snuggles/snuggles/snuggless/flag.jpg
 extracting: snuggles/snuggles/snuggless/...
   creating: snuggles/.../
 extracting: snuggles/.../...
```

Dang, that’s it? or so I thought. Things were just starting to get serious. We move.

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics/snuggles/snuggles/snuggless$ exiftool flag.jpg
ExifTool Version Number         : 12.40
File Name                       : flag.jpg
Directory                       : .
File Size                       : 100 KiB
File Modification Date/Time     : 2024:05:16 01:10:56+05:30
File Access Date/Time           : 2024:06:21 18:13:37+05:30
File Inode Change Date/Time     : 2024:06:25 11:55:49+05:30
File Permissions                : -rwxrwxrwx
Error                           : File format error
```

File format error huh. Quick google to find out the magic numbers of a jpg file.

![p2](/assets/posts/RVCECTF/p2.png)

Using `hex-edit` to fix those errors.

![p3](/assets/posts/RVCECTF/p3.png)

Now, that we have the image corrected, let’s see what it holds.

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics/snuggles/snuggles/snuggless$ file flag.jpg
flag.jpg: JPEG image data, JFIF standard 1.02, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 2010x1988, components 3
```

<img src="/assets/posts/RVCECTF/p4.jpeg" alt="p4" width="40%"/>

But before we move on, there’s a hidden detail within the zip file. If we look closely,

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics/snuggles/snuggles/snuggless$ ls -la
total 104
drwxrwxrwx 1 abu abu    512 May 16 01:12 .
drwxrwxrwx 1 abu abu    512 Jun 21 18:14 ..
-rwxrwxrwx 1 abu abu     72 May 16 01:03 ...
-rwxrwxrwx 1 abu abu 102864 Jun 25 12:02 flag.jpg
```

See the file named `…` , sneaky way to hide a file. But if you use windows or WSL2. Basically any GUI.

![p5](/assets/posts/RVCECTF/p5.png)

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics/snuggles/snuggles/snuggless$ cat ...
good job!
here's a treat -  /folders/1lJwLRBWnnDQdayQAgmlJyXTkTaRfI5WR
```

We have a link, that looks very much like a Drive link. But straight-up doing `https://drive.google.com/folders/1lJwLRBWnnDQdayQAgmlJyXTkTaRfI5WR` doesn’t work. 

Little more look up on how Drive links works, we get

`https://drive.google.com/drive/folders/1lJwLRBWnnDQdayQAgmlJyXTkTaRfI5WR`.

![p6](/assets/posts/RVCECTF/p6.png)

We find an ISO Image. Interesting.

```bash
abu@Abdur-PC:/mnt/c/Documents3/CyberSec/Tempo/RVCTF/Forensics$ file finaldiscimage.iso
finaldiscimage.iso: ISO 9660 CD-ROM filesystem data 'CDROM'
```

Mount the ISO.

Turns out it’s a Linux-Based system. Going straight into the `/home` directory.

```bash
abu@Abdur-PC:/mnt/iso/home$ ls -R -l
.:
total 12
dr-xr-xr-x 2 root root 2048 May 20 21:27 bazing
dr-xr-xr-x 2 root root 2048 May 20 21:27 bazinga
dr-xr-xr-x 2 root root 2048 May 20 21:26 santa
dr-xr-xr-x 4 root root 2048 May 20 21:28 snuggles
dr-xr-xr-x 2 root root 2048 May 20 21:26 viciousmoon
dr-xr-xr-x 2 root root 2048 May 20 21:27 whales

./bazing:
total 0

./bazinga:
total 0

./santa:
total 0

./snuggles:
total 4
dr-xr-xr-x 2 root root 2048 May 20 21:28 flag
dr-xr-xr-x 2 root root 2048 May 20 21:32 nottheflag

./snuggles/flag:
total 0

./snuggles/nottheflag:
total 562
-r--r--r-- 1 root root 575116 May 16 22:43 flag.tiff

./viciousmoon:
total 0

./whales:
total 0
```

Even though, it’s in the `/nottheflag` directory, we find a `flag.tiff` file. Which at first we thought was nothing special. But there is a twist.

The flag is hidden in the background of the file. You could use `ImageMagick` or `Aperisolve` to reveal the flag.

[Aperi'Solve](https://www.aperisolve.com/)

Here is command for `ImageMagick` in PowerShell.

```powershell
magick .\flag.tiff `
-colorspace HSL `
-channel G -separate +channel `
-threshold 50% -negate `
-compose over `
-alpha off `
.\finalFlag.tiff
```

<img src="/assets/posts/RVCECTF/woofFlag.png" alt="woof" width="25%"/>

Flag: `flag{snugGles_found_h4ppy}`

![Continue](/assets/posts/PrivEscalation/continue.jpg)
